{"version":3,"sources":["../../../src/lib/series/SARSeries.js"],"names":["SARSeries","props","renderSVG","bind","drawOnCanvas","isHover","moreProps","mouseXY","currentItem","yScale","chartConfig","yAccessor","y","currentY","ctx","fill","opacity","xAccessor","plotData","xScale","hovering","width","d","length","rx","Math","max","ry","min","forEach","centerX","each","centerY","color","close","falling","rising","fillStyle","strokeStyle","beginPath","ellipse","PI","closePath","stroke","className","map","idx","highlightOnHover","hoverProps","drawOn","canvasToDraw","onClick","onDoubleClick","onContextMenu","propTypes","string","object","isRequired","func","number","bool","defaultProps","e","console","log"],"mappings":"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","file":"SARSeries.js","sourcesContent":["\"use strict\";\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport GenericChartComponent from \"../GenericChartComponent\";\nimport { getAxisCanvas, getMouseCanvas } from \"../GenericComponent\";\n\nimport { first, last, hexToRGBA } from \"../utils\";\n\nclass SARSeries extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t\tthis.isHover = this.isHover.bind(this);\n\t}\n\tisHover(moreProps) {\n\t\tconst { mouseXY, currentItem, chartConfig: { yScale } } = moreProps;\n\t\tconst { yAccessor } = this.props;\n\t\tconst y = mouseXY[1];\n\t\tconst currentY = yScale(yAccessor(currentItem));\n\t\treturn y <  currentY + 5 && y > currentY - 5;\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tconst { yAccessor, fill, opacity } = this.props;\n\t\tconst { xAccessor, plotData, xScale, chartConfig: { yScale }, hovering } = moreProps;\n\n\t\tconst width = xScale(xAccessor(last(plotData))) - xScale(xAccessor(first(plotData)));\n\n\t\tconst d = (width / plotData.length) * 0.5 / 2;\n\t\tconst rx = Math.max(0.5,  d / 2) + (hovering ? 2 : 0);\n\t\tconst ry = Math.min(2, Math.max(0.5,  d)) + (hovering ? 0 : 0);\n\n\t\tplotData.forEach(each => {\n\t\t\tconst centerX = xScale(xAccessor(each));\n\t\t\tconst centerY = yScale(yAccessor(each));\n\t\t\tconst color = yAccessor(each) > each.close\n\t\t\t\t? fill.falling\n\t\t\t\t: fill.rising;\n\n\t\t\tctx.fillStyle = hexToRGBA(color, opacity);\n\t\t\tctx.strokeStyle = color;\n\n\t\t\tctx.beginPath();\n\t\t\tctx.ellipse(centerX, centerY, rx, ry, 0, 0, 2 * Math.PI);\n\t\t\tctx.closePath();\n\t\t\tctx.fill();\n\t\t\tctx.stroke();\n\t\t});\n\t}\n\trenderSVG(moreProps) {\n\t\tconst { className, yAccessor } = this.props;\n\t\tconst { xAccessor, plotData, xScale, chartConfig: { yScale } } = moreProps;\n\t\t// console.log(moreProps);\n\n\t\treturn <g className={className}>\n\t\t\t{plotData.map((each, idx) => {\n\t\t\t\treturn <circle key={idx} cx={xScale(xAccessor(each))}\n\t\t\t\t\tcy={yScale(yAccessor(each))} r={3} fill=\"green\" />;\n\t\t\t})}\n\t\t</g>;\n\t}\n\n\trender() {\n\t\tconst { highlightOnHover } = this.props;\n\t\tconst hoverProps = highlightOnHover\n\t\t\t? {\n\t\t\t\tisHover: this.isHover,\n\t\t\t\tdrawOn: [\"mousemove\", \"pan\"],\n\t\t\t\tcanvasToDraw: getMouseCanvas\n\t\t\t}\n\t\t\t: {\n\t\t\t\tdrawOn: [\"pan\"],\n\t\t\t\tcanvasToDraw: getAxisCanvas\n\t\t\t};\n\n\t\treturn <GenericChartComponent\n\t\t\tsvgDraw={this.renderSVG}\n\n\t\t\tcanvasDraw={this.drawOnCanvas}\n\n\t\t\tonClickWhenHover={this.props.onClick}\n\t\t\tonDoubleClickWhenHover={this.props.onDoubleClick}\n\t\t\tonContextMenuWhenHover={this.props.onContextMenu}\n\t\t\t{...hoverProps}\n\t\t/>;\n\t}\n}\n\nSARSeries.propTypes = {\n\tclassName: PropTypes.string,\n\tfill: PropTypes.object.isRequired,\n\tyAccessor: PropTypes.func.isRequired,\n\topacity: PropTypes.number.isRequired,\n\tonClick: PropTypes.func,\n\tonDoubleClick: PropTypes.func,\n\tonContextMenu: PropTypes.func,\n\thighlightOnHover: PropTypes.bool,\n};\n\nSARSeries.defaultProps = {\n\tclassName: \"react-stockcharts-sar\",\n\tfill: {\n\t\tfalling: \"#4682B4\",\n\t\trising: \"#15EC2E\",\n\t},\n\thighlightOnHover: true,\n\topacity: 0.2,\n\tonClick: function(e) { console.log(\"Click\", e); },\n\tonDoubleClick: function(e) { console.log(\"Double Click\", e); },\n\tonContextMenu: function(e) { console.log(\"Right Click\", e); },\n};\n\nexport default SARSeries;\n"]}