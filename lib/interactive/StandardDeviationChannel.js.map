{"version":3,"sources":["../../../src/lib/interactive/StandardDeviationChannel.js"],"names":["StandardDeviationChannel","props","handleStart","bind","handleEnd","handleDrawLine","handleDragLine","handleDragLineComplete","terminate","saveNodeType","getSelectionState","nodes","state","index","newXYValue","setState","override","moreProps","channels","newChannels","map","each","idx","start","x1Value","y1Value","end","x2Value","y2Value","selected","onComplete","xyValue","current","mouseMoved","console","log","onStart","e","appearance","d","enabled","snapTo","currentPositionRadius","currentPositionStroke","currentPositionOpacity","currentPositionStrokeWidth","hoverText","tempLine","eachAppearance","propTypes","bool","isRequired","func","onSelect","string","number","shape","stroke","strokeOpacity","strokeWidth","fill","fillOpacity","edgeStrokeWidth","edgeStroke","edgeFill","r","object","array","defaultProps","close","enable","bgHeight","bgWidth","text"],"mappings":"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","file":"StandardDeviationChannel.js","sourcesContent":["\"use strict\";\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { isDefined, isNotDefined, noop } from \"../utils\";\n\nimport {\n\tgetValueFromOverride,\n\tterminate,\n\tsaveNodeType,\n\tisHoverForInteractiveType,\n} from \"./utils\";\n\nimport EachLinearRegressionChannel from \"./hoc/EachLinearRegressionChannel\";\nimport MouseLocationIndicator from \"./components/MouseLocationIndicator\";\nimport HoverTextNearMouse from \"./components/HoverTextNearMouse\";\n\nclass StandardDeviationChannel extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.handleStart = this.handleStart.bind(this);\n\t\tthis.handleEnd = this.handleEnd.bind(this);\n\t\tthis.handleDrawLine = this.handleDrawLine.bind(this);\n\t\tthis.handleDragLine = this.handleDragLine.bind(this);\n\t\tthis.handleDragLineComplete = this.handleDragLineComplete.bind(this);\n\n\t\tthis.terminate = terminate.bind(this);\n\t\tthis.saveNodeType = saveNodeType.bind(this);\n\n\t\tthis.getSelectionState = isHoverForInteractiveType(\"channels\")\n\t\t\t.bind(this);\n\n\t\tthis.nodes = [];\n\t\tthis.state = {};\n\t}\n\thandleDragLine(index, newXYValue) {\n\t\tthis.setState({\n\t\t\toverride: {\n\t\t\t\tindex,\n\t\t\t\t...newXYValue\n\t\t\t}\n\t\t});\n\t}\n\thandleDragLineComplete(moreProps) {\n\t\tconst { override } = this.state;\n\t\tconst { channels } = this.props;\n\t\tif (isDefined(override)) {\n\n\t\t\tconst newChannels = channels\n\t\t\t\t.map((each, idx) => idx === override.index\n\t\t\t\t\t? {\n\t\t\t\t\t\t...each,\n\t\t\t\t\t\tstart: [override.x1Value, override.y1Value],\n\t\t\t\t\t\tend: [override.x2Value, override.y2Value],\n\t\t\t\t\t\tselected: true,\n\t\t\t\t\t}\n\t\t\t\t\t: each);\n\t\t\tthis.setState({\n\t\t\t\toverride: null,\n\t\t\t}, () => {\n\t\t\t\tthis.props.onComplete(newChannels, moreProps);\n\t\t\t});\n\t\t}\n\t}\n\thandleDrawLine(xyValue) {\n\t\tconst { current } = this.state;\n\n\t\tif (isDefined(current) && isDefined(current.start)) {\n\t\t\tthis.mouseMoved = true;\n\t\t\tconsole.log(xyValue);\n\t\t\tthis.setState({\n\t\t\t\tcurrent: {\n\t\t\t\t\tstart: current.start,\n\t\t\t\t\tend: xyValue,\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\thandleStart(xyValue) {\n\t\tconst { current } = this.state;\n\n\t\tif (isNotDefined(current) || isNotDefined(current.start)) {\n\t\t\tthis.mouseMoved = false;\n\n\t\t\tthis.setState({\n\t\t\t\tcurrent: {\n\t\t\t\t\tstart: xyValue,\n\t\t\t\t\tend: null,\n\t\t\t\t}\n\t\t\t}, () => {\n\t\t\t\tthis.props.onStart();\n\t\t\t});\n\t\t}\n\t}\n\thandleEnd(xyValue, moreProps, e) {\n\t\tconst { current } = this.state;\n\t\tconst { appearance, channels } = this.props;\n\n\t\tif (this.mouseMoved\n\t\t\t&& isDefined(current)\n\t\t\t&& isDefined(current.start)\n\t\t) {\n\t\t\tconst newChannels = [\n\t\t\t\t...channels.map(d => ({ ...d, selected: false })),\n\t\t\t\t{\n\t\t\t\t\tstart: current.start,\n\t\t\t\t\tend: xyValue,\n\t\t\t\t\tselected: true,\n\t\t\t\t\tappearance,\n\t\t\t\t}\n\t\t\t];\n\n\t\t\tthis.setState({\n\t\t\t\tcurrent: null,\n\t\t\t}, () => {\n\t\t\t\tthis.props.onComplete(newChannels, moreProps, e);\n\t\t\t});\n\t\t}\n\t}\n\trender() {\n\t\tconst { appearance } = this.props;\n\t\tconst { enabled, snapTo } = this.props;\n\t\tconst { currentPositionRadius, currentPositionStroke } = this.props;\n\t\tconst { currentPositionOpacity, currentPositionStrokeWidth } = this.props;\n\t\tconst { hoverText, channels } = this.props;\n\t\tconst { current, override } = this.state;\n\n\t\tconst tempLine = isDefined(current) && isDefined(current.end)\n\t\t\t? <EachLinearRegressionChannel\n\t\t\t\tinteractive={false}\n\t\t\t\tx1Value={current.start[0]}\n\t\t\t\tx2Value={current.end[0]}\n\t\t\t\tappearance={appearance}\n\t\t\t\thoverText={hoverText}\n\t\t\t/>\n\t\t\t: null;\n\n\t\treturn <g>\n\t\t\t{channels.map((each, idx) => {\n\t\t\t\tconst eachAppearance = isDefined(each.appearance)\n\t\t\t\t\t? { ...appearance, ...each.appearance }\n\t\t\t\t\t: appearance;\n\n\t\t\t\treturn <EachLinearRegressionChannel key={idx}\n\t\t\t\t\tref={this.saveNodeType(idx)}\n\t\t\t\t\tindex={idx}\n\t\t\t\t\tselected={each.selected}\n\n\t\t\t\t\tx1Value={getValueFromOverride(override, idx, \"x1Value\", each.start[0])}\n\t\t\t\t\tx2Value={getValueFromOverride(override, idx, \"x2Value\", each.end[0])}\n\n\t\t\t\t\tappearance={eachAppearance}\n\t\t\t\t\tsnapTo={snapTo}\n\t\t\t\t\thoverText={hoverText}\n\n\t\t\t\t\tonDrag={this.handleDragLine}\n\t\t\t\t\tonDragComplete={this.handleDragLineComplete}\n\t\t\t\t\tedgeInteractiveCursor=\"react-stockcharts-move-cursor\"\n\t\t\t\t/>;\n\t\t\t})}\n\t\t\t{tempLine}\n\t\t\t<MouseLocationIndicator\n\t\t\t\tenabled={enabled}\n\t\t\t\tsnap\n\t\t\t\tsnapTo={snapTo}\n\t\t\t\tr={currentPositionRadius}\n\t\t\t\tstroke={currentPositionStroke}\n\t\t\t\topacity={currentPositionOpacity}\n\t\t\t\tstrokeWidth={currentPositionStrokeWidth}\n\t\t\t\tonMouseDown={this.handleStart}\n\t\t\t\tonClick={this.handleEnd}\n\t\t\t\tonMouseMove={this.handleDrawLine}\n\t\t\t/>\n\t\t</g>;\n\t}\n}\n\nStandardDeviationChannel.propTypes = {\n\tenabled: PropTypes.bool.isRequired,\n\tsnapTo: PropTypes.func.isRequired,\n\n\tonStart: PropTypes.func.isRequired,\n\tonComplete: PropTypes.func.isRequired,\n\tonSelect: PropTypes.func,\n\n\tcurrentPositionStroke: PropTypes.string,\n\tcurrentPositionStrokeWidth: PropTypes.number,\n\tcurrentPositionOpacity: PropTypes.number,\n\tcurrentPositionRadius: PropTypes.number,\n\n\tappearance: PropTypes.shape({\n\t\tstroke: PropTypes.string.isRequired,\n\t\tstrokeOpacity: PropTypes.number.isRequired,\n\t\tstrokeWidth: PropTypes.number.isRequired,\n\t\tfill: PropTypes.string.isRequired,\n\t\tfillOpacity: PropTypes.number.isRequired,\n\t\tedgeStrokeWidth: PropTypes.number.isRequired,\n\t\tedgeStroke: PropTypes.string.isRequired,\n\t\tedgeFill: PropTypes.string.isRequired,\n\t\tr: PropTypes.number.isRequired,\n\t}).isRequired,\n\n\thoverText: PropTypes.object.isRequired,\n\tchannels: PropTypes.array.isRequired,\n};\n\nStandardDeviationChannel.defaultProps = {\n\tsnapTo: d => d.close,\n\tappearance: {\n\t\tstroke: \"#000000\",\n\t\tfillOpacity: 0.2,\n\t\tstrokeOpacity: 1,\n\t\tstrokeWidth: 1,\n\t\tfill: \"#8AAFE2\",\n\t\tedgeStrokeWidth: 2,\n\t\tedgeStroke: \"#000000\",\n\t\tedgeFill: \"#FFFFFF\",\n\t\tr: 5,\n\t},\n\n\tonStart: noop,\n\tonComplete: noop,\n\tonSelect: noop,\n\n\tcurrentPositionStroke: \"#000000\",\n\tcurrentPositionOpacity: 1,\n\tcurrentPositionStrokeWidth: 3,\n\tcurrentPositionRadius: 4,\n\n\thoverText: {\n\t\t...HoverTextNearMouse.defaultProps,\n\t\tenable: true,\n\t\tbgHeight: 18,\n\t\tbgWidth: 175,\n\t\ttext: \"Click and drag the edge circles\",\n\t},\n\tchannels: [],\n};\n\nexport default StandardDeviationChannel;\n"]}