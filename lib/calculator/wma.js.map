{"version":3,"sources":["../../../src/lib/calculator/wma.js"],"names":["options","calculator","data","windowSize","sourcePath","weight","waverage","accumulator","total","values","v","i","undefinedLength","x","arguments","length"],"mappings":"AAAA;;;;;;;;kBAOe,YAAW;;AAEzB,KAAIA,2CAAJ;;AAEA,UAASC,UAAT,CAAoBC,IAApB,EAA6B;AAAA,iBACOF,OADP;AAAA,MACpBG,UADoB,YACpBA,UADoB;AAAA,MACRC,UADQ,YACRA,UADQ;;;AAG5B,MAAMC,SAASF,cAAcA,aAAa,CAA3B,IAAgC,CAA/C;;AAEA,MAAMG,WAAW,4BACfH,UADe,CACJA,UADI,EAEfC,UAFe,CAEJA,UAFI,EAGfG,WAHe,CAGH,kBAAU;AACtB,OAAMC,QAAQ,kBAAIC,MAAJ,EAAY,UAACC,CAAD,EAAIC,CAAJ,EAAU;AACnC,WAAO,CAACA,IAAI,CAAL,IAAUD,CAAjB;AACA,IAFa,CAAd;AAGA,UAAOF,QAAQH,MAAf;AACA,GARe,CAAjB;;AAUA,SAAOC,SAASJ,IAAT,CAAP;AACA;AACDD,YAAWW,eAAX,GAA6B,YAAW;AAAA,kBAChBZ,OADgB;AAAA,MAC/BG,UAD+B,aAC/BA,UAD+B;;;AAGvC,SAAOA,aAAa,CAApB;AACA,EAJD;AAKAF,YAAWD,OAAX,GAAqB,UAASa,CAAT,EAAY;AAChC,MAAI,CAACC,UAAUC,MAAf,EAAuB;AACtB,UAAOf,OAAP;AACA;AACDA,4DAAkCa,CAAlC;AACA,SAAOZ,UAAP;AACA,EAND;;AAQA,QAAOA,UAAP;AACA,C;;AAxCD;;AAEA;;AACA","file":"wma.js","sourcesContent":["\"use strict\";\n\nimport { sum } from \"d3-array\";\n\nimport { slidingWindow } from \"../utils\";\nimport { WMA as defaultOptions } from \"./defaultOptionsForComputation\";\n\nexport default function() {\n\n\tlet options = defaultOptions;\n\n\tfunction calculator(data)    {\n\t\tconst { windowSize, sourcePath } = options;\n\n\t\tconst weight = windowSize * (windowSize + 1) / 2;\n\n\t\tconst waverage = slidingWindow()\n\t\t\t.windowSize(windowSize)\n\t\t\t.sourcePath(sourcePath)\n\t\t\t.accumulator(values => {\n\t\t\t\tconst total = sum(values, (v, i) => {\n\t\t\t\t\treturn (i + 1) * v;\n\t\t\t\t});\n\t\t\t\treturn total / weight;\n\t\t\t});\n\n\t\treturn waverage(data);\n\t}\n\tcalculator.undefinedLength = function() {\n\t\tconst { windowSize } = options;\n\n\t\treturn windowSize - 1;\n\t};\n\tcalculator.options = function(x) {\n\t\tif (!arguments.length) {\n\t\t\treturn options;\n\t\t}\n\t\toptions = { ...defaultOptions, ...x };\n\t\treturn calculator;\n\t};\n\n\treturn calculator;\n}\n"]}